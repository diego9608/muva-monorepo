<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Pron√≥sticos interactivos y unit economics - Industria de puertas M√©xico 2025-2033">
  <title>Forecast & Economics | Puertas MX 2025</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.4/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.4/dist/ScrollTrigger.min.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #0f172a;
      --primary-light: #1e293b;
      --secondary: #475569;
      --accent: #3b82f6;
      --accent-dark: #2563eb;
      --mexico: #dc2626;
      --success: #10b981;
      --warning: #f59e0b;
      --muted: #94a3b8;
      --light: #f8fafc;
      --white: #ffffff;
      --border: #e2e8f0;
      --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-mexico: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
      --gradient-success: linear-gradient(135deg, #10b981 0%, #059669 100%);
      --gradient-warning: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    }

    html {
      scroll-behavior: smooth;
      font-size: 16px;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(to bottom, var(--white), var(--light));
      color: var(--primary);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      z-index: 1000;
      backdrop-filter: blur(10px);
    }

    .progress-bar {
      height: 100%;
      background: var(--gradient-primary);
      width: 0%;
      transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Navigation */
    .nav-container {
      position: fixed;
      right: 2rem;
      top: 50%;
      transform: translateY(-50%);
      z-index: 100;
    }

    .nav-dots {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .nav-dot {
      position: relative;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--border);
      border: 2px solid var(--white);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .nav-dot.active {
      background: var(--accent);
      transform: scale(1.4);
      box-shadow: 0 0 0 8px rgba(59, 130, 246, 0.1);
    }

    .nav-tooltip {
      position: absolute;
      right: 24px;
      top: 50%;
      transform: translateY(-50%);
      background: var(--primary);
      color: var(--white);
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .nav-dot:hover .nav-tooltip {
      opacity: 1;
    }

    /* Sections */
    .section {
      min-height: 100vh;
      padding: 4rem 2rem;
      display: flex;
      align-items: center;
      position: relative;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
    }

    /* Typography */
    h1 {
      font-size: clamp(2.5rem, 5vw, 4rem);
      font-weight: 900;
      line-height: 1.1;
      margin-bottom: 1.5rem;
    }

    h2 {
      font-size: clamp(2rem, 4vw, 3rem);
      font-weight: 800;
      line-height: 1.2;
      margin-bottom: 1rem;
      color: var(--primary);
    }

    h3 {
      font-size: clamp(1.5rem, 3vw, 2rem);
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    .subtitle {
      font-size: 1.25rem;
      color: var(--secondary);
      margin-bottom: 2rem;
    }

    /* Cards */
    .card {
      background: var(--white);
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      border: 1px solid var(--border);
    }

    /* Controls Panel */
    .controls-panel {
      background: var(--white);
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      border: 1px solid var(--border);
      margin-bottom: 2rem;
    }

    .control-group {
      margin-bottom: 1.5rem;
    }

    .control-group:last-child {
      margin-bottom: 0;
    }

    .control-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--primary);
    }

    .control-value {
      font-family: 'JetBrains Mono', monospace;
      font-weight: 600;
      color: var(--accent);
      background: var(--light);
      padding: 0.25rem 0.5rem;
      border-radius: 6px;
    }

    /* Sliders */
    .slider {
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: var(--border);
      outline: none;
      -webkit-appearance: none;
      appearance: none;
      cursor: pointer;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      transition: all 0.2s ease;
    }

    .slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      background: var(--accent-dark);
    }

    .slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      transition: all 0.2s ease;
    }

    /* Scenario Buttons */
    .scenario-buttons {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .scenario-btn {
      flex: 1;
      padding: 1rem;
      border: 2px solid var(--border);
      background: var(--white);
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .scenario-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
    }

    .scenario-btn.active {
      background: var(--accent);
      color: var(--white);
      border-color: var(--accent);
    }

    .scenario-btn.base { border-color: var(--accent); color: var(--accent); }
    .scenario-btn.alcista { border-color: var(--success); color: var(--success); }
    .scenario-btn.bajista { border-color: var(--warning); color: var(--warning); }
    
    .scenario-btn.base.active { background: var(--accent); }
    .scenario-btn.alcista.active { background: var(--success); }
    .scenario-btn.bajista.active { background: var(--warning); }

    /* Data Tables */
    .data-table {
      width: 100%;
      background: var(--white);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
    }

    .data-table th {
      background: var(--gradient-primary);
      color: var(--white);
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .data-table td {
      padding: 1rem;
      border-bottom: 1px solid var(--border);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
    }

    .data-table tr:hover {
      background: var(--light);
    }

    /* Metrics Grid */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .metric-card {
      background: var(--white);
      border-radius: 12px;
      padding: 1.5rem;
      border: 1px solid var(--border);
      transition: all 0.3s ease;
    }

    .metric-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1);
    }

    .metric-value {
      font-size: 2rem;
      font-weight: 800;
      line-height: 1;
      margin-bottom: 0.5rem;
      font-family: 'JetBrains Mono', monospace;
    }

    .metric-label {
      font-size: 0.875rem;
      color: var(--secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .metric-change {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      margin-top: 0.5rem;
      padding: 0.25rem 0.5rem;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .metric-change.positive {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
    }

    .metric-change.negative {
      background: rgba(239, 68, 68, 0.1);
      color: var(--mexico);
    }

    /* Export Buttons */
    .export-container {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      display: flex;
      gap: 1rem;
      z-index: 100;
    }

    .export-btn {
      background: var(--gradient-primary);
      color: var(--white);
      padding: 1rem 2rem;
      border-radius: 50px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .export-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1);
    }

    /* Formula Display */
    .formula-display {
      background: var(--light);
      border-left: 4px solid var(--accent);
      padding: 1rem 1.5rem;
      border-radius: 8px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      margin: 1rem 0;
    }

    .formula-title {
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 0.5rem;
    }

    /* Chart Container */
    .chart-container {
      position: relative;
      width: 100%;
      height: 400px;
      margin: 2rem 0;
      padding: 1rem;
      background: var(--white);
      border-radius: 12px;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .nav-container {
        display: none;
      }

      .export-container {
        bottom: 1rem;
        right: 1rem;
        left: 1rem;
        flex-direction: column;
      }

      .scenario-buttons {
        flex-direction: column;
      }

      .metrics-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Loading Spinner */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid var(--border);
      border-radius: 50%;
      border-top-color: var(--accent);
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Seed Badge */
    .seed-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      background: var(--gradient-mexico);
      color: var(--white);
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      font-weight: 600;
      font-size: 0.875rem;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
  </style>
</head>
<body>
  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <!-- Navigation -->
  <nav class="nav-container">
    <div class="nav-dots" id="navDots"></div>
  </nav>

  <!-- Export Buttons -->
  <div class="export-container">
    <button class="export-btn" onclick="exportCSV()">
      üìä CSV Forecast
    </button>
    <button class="export-btn" onclick="exportJSON()">
      üîß JSON Supuestos
    </button>
  </div>

  <!-- SECTION 1: Pron√≥sticos Interactivos -->
  <section class="section" id="pronosticos">
    <div class="container">
      <div class="seed-badge">
        <span>SEED DATA</span>
        <span>Datos preliminares - Reemplazables</span>
      </div>
      
      <h1>Pron√≥sticos 2025-2033</h1>
      <p class="subtitle">Modelado interactivo con escenarios ajustables</p>

      <!-- Scenario Buttons -->
      <div class="scenario-buttons">
        <button class="scenario-btn base active" onclick="setScenario('base')">
          üìä Escenario Base
          <div style="font-size: 0.875rem; font-weight: 400; margin-top: 0.25rem;">CAGR 5.65%</div>
        </button>
        <button class="scenario-btn alcista" onclick="setScenario('alcista')">
          üöÄ Escenario Alcista
          <div style="font-size: 0.875rem; font-weight: 400; margin-top: 0.25rem;">CAGR 7.5%</div>
        </button>
        <button class="scenario-btn bajista" onclick="setScenario('bajista')">
          ‚ö†Ô∏è Escenario Bajista
          <div style="font-size: 0.875rem; font-weight: 400; margin-top: 0.25rem;">CAGR 3.0%</div>
        </button>
      </div>

      <!-- Controls Panel -->
      <div class="controls-panel">
        <h3>Par√°metros Ajustables</h3>
        
        <div class="control-group">
          <div class="control-label">
            <span>CAGR Base (%)</span>
            <span class="control-value" id="cagrValue">5.65%</span>
          </div>
          <input type="range" class="slider" id="cagrSlider" min="0" max="15" step="0.05" value="5.65">
        </div>

        <div class="control-group">
          <div class="control-label">
            <span>Shock CAGR (puntos porcentuales)</span>
            <span class="control-value" id="shockValue">0.0pp</span>
          </div>
          <input type="range" class="slider" id="shockSlider" min="-5" max="5" step="0.1" value="0">
        </div>

        <div class="control-group">
          <div class="control-label">
            <span>Attach Rate Kit (%)</span>
            <span class="control-value" id="kitValue">22%</span>
          </div>
          <input type="range" class="slider" id="kitSlider" min="0" max="50" step="1" value="22">
        </div>

        <div class="control-group">
          <div class="control-label">
            <span>Attach Rate Pre-hung (%)</span>
            <span class="control-value" id="prehungValue">8%</span>
          </div>
          <input type="range" class="slider" id="prehungSlider" min="0" max="30" step="1" value="8">
        </div>
      </div>

      <!-- Formula Display -->
      <div class="formula-display">
        <div class="formula-title">üìê F√≥rmula CAGR</div>
        <div>Valor_futuro = Valor_inicial √ó (1 + CAGR)^a√±os</div>
        <div style="margin-top: 0.5rem; color: var(--secondary);">
          Ejemplo: $44.6B √ó (1.0565)^9 = $72.9B MXN
        </div>
      </div>

      <!-- Forecast Chart -->
      <div class="chart-container">
        <canvas id="forecastChart"></canvas>
      </div>

      <!-- Metrics Grid -->
      <div class="metrics-grid">
        <div class="metric-card">
          <div class="metric-value" id="tam2025">$47.1B</div>
          <div class="metric-label">TAM 2025 (MXN)</div>
          <div class="metric-change positive">‚Üë 5.65%</div>
        </div>
        <div class="metric-card">
          <div class="metric-value" id="tam2030">$62.5B</div>
          <div class="metric-label">TAM 2030 (MXN)</div>
          <div class="metric-change positive">‚Üë 32.4%</div>
        </div>
        <div class="metric-card">
          <div class="metric-value" id="tam2033">$72.9B</div>
          <div class="metric-label">TAM 2033 (MXN)</div>
          <div class="metric-change positive">‚Üë 63.5%</div>
        </div>
        <div class="metric-card">
          <div class="metric-value" id="unidades2033">2.4M</div>
          <div class="metric-label">Unidades 2033</div>
          <div class="metric-change positive">‚Üë 66%</div>
        </div>
      </div>

      <!-- Forecast Table -->
      <table class="data-table">
        <thead>
          <tr>
            <th>A√±o</th>
            <th>Unidades (M)</th>
            <th>Precio Promedio</th>
            <th>TAM (MXN B)</th>
            <th>Growth YoY</th>
            <th>Kit Revenue</th>
            <th>Pre-hung Revenue</th>
          </tr>
        </thead>
        <tbody id="forecastTable">
          <!-- Populated by JavaScript -->
        </tbody>
      </table>
    </div>
  </section>

  <!-- SECTION 2: Unit Economics -->
  <section class="section" id="unit-economics">
    <div class="container">
      <h2>Unit Economics</h2>
      <p class="subtitle">Estructura de costos y m√°rgenes por producto</p>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
        <!-- BOM Breakdown -->
        <div class="card">
          <h3>üí∞ BOM Desglosado (Puerta Tambor)</h3>
          <table style="width: 100%; margin-top: 1rem;">
            <tr style="border-bottom: 2px solid var(--border);">
              <th style="text-align: left; padding: 0.75rem 0;">Componente</th>
              <th style="text-align: right; padding: 0.75rem 0;">Costo (MXN)</th>
              <th style="text-align: right; padding: 0.75rem 0;">%</th>
            </tr>
            <tr>
              <td style="padding: 0.5rem 0;">Caras (MDF 3mm)</td>
              <td style="text-align: right; font-family: 'JetBrains Mono', monospace;">$85</td>
              <td style="text-align: right; color: var(--secondary);">24.3%</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem 0;">Bastidor (pino)</td>
              <td style="text-align: right; font-family: 'JetBrains Mono', monospace;">$65</td>
              <td style="text-align: right; color: var(--secondary);">18.6%</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem 0;">N√∫cleo (honeycomb)</td>
              <td style="text-align: right; font-family: 'JetBrains Mono', monospace;">$35</td>
              <td style="text-align: right; color: var(--secondary);">10.0%</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem 0;">Adhesivos</td>
              <td style="text-align: right; font-family: 'JetBrains Mono', monospace;">$25</td>
              <td style="text-align: right; color: var(--secondary);">7.1%</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem 0;">MOD</td>
              <td style="text-align: right; font-family: 'JetBrains Mono', monospace;">$55</td>
              <td style="text-align: right; color: var(--secondary);">15.7%</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem 0;">Energ√≠a/Overhead</td>
              <td style="text-align: right; font-family: 'JetBrains Mono', monospace;">$40</td>
              <td style="text-align: right; color: var(--secondary);">11.4%</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem 0;">Empaque/Merma</td>
              <td style="text-align: right; font-family: 'JetBrains Mono', monospace;">$25</td>
              <td style="text-align: right; color: var(--secondary);">7.1%</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem 0;">Log√≠stica</td>
              <td style="text-align: right; font-family: 'JetBrains Mono', monospace;">$20</td>
              <td style="text-align: right; color: var(--secondary);">5.7%</td>
            </tr>
            <tr style="border-top: 2px solid var(--border); font-weight: 700;">
              <td style="padding: 0.75rem 0;">COSTO TOTAL</td>
              <td style="text-align: right; font-family: 'JetBrains Mono', monospace; color: var(--mexico);">$350</td>
              <td style="text-align: right;">100%</td>
            </tr>
          </table>
        </div>

        <!-- Margin Ladder -->
        <div class="card">
          <h3>üìà Escalera de M√°rgenes</h3>
          <div style="margin-top: 1rem;">
            <div style="padding: 1rem; background: linear-gradient(to right, var(--light), var(--white)); border-radius: 8px; margin-bottom: 1rem;">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="font-weight: 600;">Hoja Sola</span>
                <span style="font-family: 'JetBrains Mono', monospace; font-weight: 700; color: var(--accent);">$550</span>
              </div>
              <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                <span style="color: var(--secondary); font-size: 0.875rem;">Margen Bruto</span>
                <span style="font-family: 'JetBrains Mono', monospace; color: var(--success);">36.4%</span>
              </div>
            </div>

            <div style="padding: 1rem; background: linear-gradient(to right, rgba(59, 130, 246, 0.1), var(--white)); border-radius: 8px; margin-bottom: 1rem;">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="font-weight: 600;">+ Kit Completo</span>
                <span style="font-family: 'JetBrains Mono', monospace; font-weight: 700; color: var(--accent);">$850</span>
              </div>
              <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                <span style="color: var(--secondary); font-size: 0.875rem;">Margen Bruto</span>
                <span style="font-family: 'JetBrains Mono', monospace; color: var(--success);">42.3%</span>
              </div>
              <div style="margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid var(--border);">
                <span style="color: var(--secondary); font-size: 0.75rem;">Uplift: +$300 | Costo adicional: $140</span>
              </div>
            </div>

            <div style="padding: 1rem; background: linear-gradient(to right, rgba(16, 185, 129, 0.1), var(--white)); border-radius: 8px; margin-bottom: 1rem;">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="font-weight: 600;">+ Pre-hung/Block</span>
                <span style="font-family: 'JetBrains Mono', monospace; font-weight: 700; color: var(--accent);">$1,000</span>
              </div>
              <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                <span style="color: var(--secondary); font-size: 0.875rem;">Margen Bruto</span>
                <span style="font-family: 'JetBrains Mono', monospace; color: var(--success);">44.5%</span>
              </div>
              <div style="margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid var(--border);">
                <span style="color: var(--secondary); font-size: 0.75rem;">Uplift: +$450 | Costo adicional: $205</span>
              </div>
            </div>

            <div style="padding: 1rem; background: linear-gradient(to right, rgba(245, 158, 11, 0.1), var(--white)); border-radius: 8px;">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="font-weight: 600;">+ Instalaci√≥n</span>
                <span style="font-family: 'JetBrains Mono', monospace; font-weight: 700; color: var(--accent);">$1,400</span>
              </div>
              <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                <span style="color: var(--secondary); font-size: 0.875rem;">Margen Bruto</span>
                <span style="font-family: 'JetBrains Mono', monospace; color: var(--success);">48.6%</span>
              </div>
              <div style="margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid var(--border);">
                <span style="color: var(--secondary); font-size: 0.75rem;">Uplift: +$400 | Costo MO: $175</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Margin Waterfall Chart -->
      <div class="chart-container">
        <canvas id="marginChart"></canvas>
      </div>

      <!-- Key Insight -->
      <div class="card" style="margin-top: 2rem; background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);">
        <h3>üí° Insight Clave: Las Palancas de Margen</h3>
        <p style="font-size: 1.125rem; line-height: 1.8; margin-top: 1rem;">
          Incrementar el attach rate de kits del 22% al 35% genera <strong>+$195M MXN</strong> adicionales en margen bruto anual,
          equivalente a reducir costos 8% en toda la operaci√≥n. <strong>La batalla est√° en el mix, no en el costo.</strong>
        </p>
        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
          <p style="color: var(--secondary);">
            üìä Cada punto porcentual de attach rate kit = $15M MXN margen adicional<br>
            üìä Cada punto porcentual de attach rate pre-hung = $36M MXN margen adicional
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- SECTION 3: M√°rgenes por Canal -->
  <section class="section" id="margenes-canal">
    <div class="container">
      <h2>M√°rgenes por Canal</h2>
      <p class="subtitle">An√°lisis de rentabilidad y condiciones comerciales</p>

      <table class="data-table">
        <thead>
          <tr>
            <th>Canal</th>
            <th>Share (%)</th>
            <th>Precio Prom</th>
            <th>Margen Canal</th>
            <th>D√≠as Pago</th>
            <th>Attach Kit</th>
            <th>Attach Pre-hung</th>
            <th>GMROI</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>üè™ Ferreter√≠as</strong></td>
            <td>42%</td>
            <td>$850</td>
            <td>28-35%</td>
            <td>30-45</td>
            <td>18%</td>
            <td>3%</td>
            <td>3.2x</td>
          </tr>
          <tr>
            <td><strong>üèóÔ∏è Constructoras</strong></td>
            <td>38%</td>
            <td>$680</td>
            <td>18-25%</td>
            <td>60-90</td>
            <td>35%</td>
            <td>15%</td>
            <td>2.1x</td>
          </tr>
          <tr>
            <td><strong>üè¨ Retail Moderno</strong></td>
            <td>12%</td>
            <td>$1,200</td>
            <td>35-45%</td>
            <td>45-60</td>
            <td>45%</td>
            <td>12%</td>
            <td>4.5x</td>
          </tr>
          <tr>
            <td><strong>üè¢ Institucional</strong></td>
            <td>8%</td>
            <td>$2,400</td>
            <td>40-50%</td>
            <td>90-120</td>
            <td>65%</td>
            <td>25%</td>
            <td>2.8x</td>
          </tr>
        </tbody>
      </table>

      <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 2rem; margin-top: 2rem;">
        <div class="card">
          <h3>üìä An√°lisis de Rentabilidad</h3>
          <canvas id="channelProfitChart"></canvas>
        </div>
        
        <div class="card">
          <h3>üí∞ Working Capital por Canal</h3>
          <canvas id="workingCapitalChart"></canvas>
        </div>
      </div>

      <div class="metrics-grid">
        <div class="metric-card">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div class="metric-label">Canal M√°s Rentable</div>
              <div class="metric-value" style="color: var(--success);">Retail</div>
            </div>
            <div style="font-size: 2.5rem;">üè¨</div>
          </div>
          <div class="metric-change positive">GMROI 4.5x</div>
        </div>
        
        <div class="metric-card">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div class="metric-label">Mayor Volumen</div>
              <div class="metric-value" style="color: var(--accent);">Ferreter√≠as</div>
            </div>
            <div style="font-size: 2.5rem;">üè™</div>
          </div>
          <div class="metric-change positive">42% share</div>
        </div>
        
        <div class="metric-card">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div class="metric-label">Mayor Riesgo</div>
              <div class="metric-value" style="color: var(--warning);">Constructoras</div>
            </div>
            <div style="font-size: 2.5rem;">üèóÔ∏è</div>
          </div>
          <div class="metric-change negative">90 d√≠as pago</div>
        </div>
        
        <div class="metric-card">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div class="metric-label">Mayor Ticket</div>
              <div class="metric-value" style="color: var(--mexico);">Institucional</div>
            </div>
            <div style="font-size: 2.5rem;">üè¢</div>
          </div>
          <div class="metric-change positive">$2,400 avg</div>
        </div>
      </div>

      <!-- Channel Strategy Matrix -->
      <div class="card" style="margin-top: 2rem;">
        <h3>üéØ Matriz Estrat√©gica por Canal</h3>
        <table style="width: 100%; margin-top: 1rem;">
          <thead>
            <tr style="background: var(--light);">
              <th style="padding: 1rem; text-align: left;">Canal</th>
              <th style="padding: 1rem; text-align: left;">Estrategia Recomendada</th>
              <th style="padding: 1rem; text-align: left;">KPIs Clave</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 1rem; vertical-align: top;"><strong>Ferreter√≠as</strong></td>
              <td style="padding: 1rem; vertical-align: top;">
                ‚Ä¢ Programa de lealtad con rebates escalonados<br>
                ‚Ä¢ Capacitaci√≥n t√©cnica para aumentar attach kits<br>
                ‚Ä¢ Financiamiento 30-45 d√≠as para top performers
              </td>
              <td style="padding: 1rem; vertical-align: top;">
                ‚Ä¢ Attach rate kit > 25%<br>
                ‚Ä¢ Rotaci√≥n > 12x a√±o<br>
                ‚Ä¢ DSO < 45 d√≠as
              </td>
            </tr>
            <tr style="background: var(--light);">
              <td style="padding: 1rem; vertical-align: top;"><strong>Constructoras</strong></td>
              <td style="padding: 1rem; vertical-align: top;">
                ‚Ä¢ Contratos anuales con precio fijo<br>
                ‚Ä¢ Inventario consignado en obras grandes<br>
                ‚Ä¢ Servicio de pre-instalaci√≥n en planta
              </td>
              <td style="padding: 1rem; vertical-align: top;">
                ‚Ä¢ Volumen m√≠nimo 500 puertas/mes<br>
                ‚Ä¢ Attach pre-hung > 20%<br>
                ‚Ä¢ Cumplimiento entrega > 95%
              </td>
            </tr>
            <tr>
              <td style="padding: 1rem; vertical-align: top;"><strong>Retail Moderno</strong></td>
              <td style="padding: 1rem; vertical-align: top;">
                ‚Ä¢ SKUs exclusivos con mayor margen<br>
                ‚Ä¢ Promotores en piso fines de semana<br>
                ‚Ä¢ Bundle con instalaci√≥n
              </td>
              <td style="padding: 1rem; vertical-align: top;">
                ‚Ä¢ Sell-through > 85%<br>
                ‚Ä¢ Attach instalaci√≥n > 30%<br>
                ‚Ä¢ GMROI > 4.0x
              </td>
            </tr>
            <tr style="background: var(--light);">
              <td style="padding: 1rem; vertical-align: top;"><strong>Institucional</strong></td>
              <td style="padding: 1rem; vertical-align: top;">
                ‚Ä¢ Especificaci√≥n t√©cnica desde dise√±o<br>
                ‚Ä¢ Garant√≠as extendidas (3-5 a√±os)<br>
                ‚Ä¢ Servicio post-venta premium
              </td>
              <td style="padding: 1rem; vertical-align: top;">
                ‚Ä¢ Win rate licitaciones > 35%<br>
                ‚Ä¢ Margen neto > 25%<br>
                ‚Ä¢ NPS > 80
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <script>
    // Complete Data Model
    const dataModel = {
      assumptions: {
        currency: 'MXN',
        usd_mxn: 20.27,
        door_price_base: 550,
        kit_uplift: 300,
        prehung_uplift: 450,
        install_uplift: 400,
        attach_kit_default: 0.22,
        attach_prehung_default: 0.08,
        cagr_base: 5.65
      },
      market: {
        tam_mxn_2024: 44600000000,
        units_2024: 1650000,
        price_avg_2024: 750
      },
      costs: {
        bom: {
          caras: 85,
          bastidor: 65,
          nucleo: 35,
          adhesivos: 25,
          mod: 55,
          overhead: 40,
          empaque: 25,
          logistica: 20
        },
        total: 350
      },
      channels: {
        ferreterias: {
          share: 0.42,
          price_avg: 850,
          margin_range: [0.28, 0.35],
          payment_days: [30, 45],
          attach_kit: 0.18,
          attach_prehung: 0.03,
          gmroi: 3.2
        },
        constructoras: {
          share: 0.38,
          price_avg: 680,
          margin_range: [0.18, 0.25],
          payment_days: [60, 90],
          attach_kit: 0.35,
          attach_prehung: 0.15,
          gmroi: 2.1
        },
        retail_moderno: {
          share: 0.12,
          price_avg: 1200,
          margin_range: [0.35, 0.45],
          payment_days: [45, 60],
          attach_kit: 0.45,
          attach_prehung: 0.12,
          gmroi: 4.5
        },
        institucional: {
          share: 0.08,
          price_avg: 2400,
          margin_range: [0.40, 0.50],
          payment_days: [90, 120],
          attach_kit: 0.65,
          attach_prehung: 0.25,
          gmroi: 2.8
        }
      }
    };

    // Current State
    let currentScenario = 'base';
    let currentParams = {
      cagr: 5.65,
      shock: 0,
      attachKit: 22,
      attachPrehung: 8
    };

    // Navigation sections
    const sections = [
      { id: 'pronosticos', title: 'Pron√≥sticos' },
      { id: 'unit-economics', title: 'Unit Economics' },
      { id: 'margenes-canal', title: 'M√°rgenes Canal' }
    ];

    // Initialize navigation
    function initNavigation() {
      const navDots = document.getElementById('navDots');
      sections.forEach((section, index) => {
        const dot = document.createElement('div');
        dot.className = 'nav-dot';
        if (index === 0) dot.classList.add('active');
        
        const tooltip = document.createElement('span');
        tooltip.className = 'nav-tooltip';
        tooltip.textContent = section.title;
        dot.appendChild(tooltip);
        
        dot.addEventListener('click', () => {
          document.getElementById(section.id).scrollIntoView({ behavior: 'smooth' });
        });
        
        navDots.appendChild(dot);
      });
    }

    // Update progress bar
    function updateProgress() {
      const scrolled = window.scrollY;
      const total = document.documentElement.scrollHeight - window.innerHeight;
      const progress = (scrolled / total) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      
      // Update active dot
      const dots = document.querySelectorAll('.nav-dot');
      sections.forEach((section, index) => {
        const element = document.getElementById(section.id);
        const rect = element.getBoundingClientRect();
        if (rect.top <= 150 && rect.bottom >= 150) {
          dots.forEach(d => d.classList.remove('active'));
          dots[index].classList.add('active');
        }
      });
    }

    // Calculate forecast
    function calculateForecast() {
      const years = [];
      const values = [];
      const units = [];
      const kitRevenue = [];
      const prehungRevenue = [];
      
      const startYear = 2024;
      const endYear = 2033;
      const baseValue = dataModel.market.tam_mxn_2024;
      const baseUnits = dataModel.market.units_2024;
      const effectiveCagr = (currentParams.cagr + currentParams.shock) / 100;
      
      for (let year = startYear; year <= endYear; year++) {
        const yearsFromBase = year - startYear;
        const value = baseValue * Math.pow(1 + effectiveCagr, yearsFromBase);
        const unitsYear = baseUnits * Math.pow(1 + effectiveCagr, yearsFromBase);
        
        years.push(year);
        values.push(value);
        units.push(unitsYear);
        
        // Calculate kit and pre-hung revenue
        const kitRev = unitsYear * (currentParams.attachKit / 100) * dataModel.assumptions.kit_uplift;
        const prehungRev = unitsYear * (currentParams.attachPrehung / 100) * dataModel.assumptions.prehung_uplift;
        
        kitRevenue.push(kitRev);
        prehungRevenue.push(prehungRev);
      }
      
      return { years, values, units, kitRevenue, prehungRevenue };
    }

    // Update forecast display
    function updateForecast() {
      const forecast = calculateForecast();
      
      // Update metrics
      document.getElementById('tam2025').textContent = `$${(forecast.values[1] / 1e9).toFixed(1)}B`;
      document.getElementById('tam2030').textContent = `$${(forecast.values[6] / 1e9).toFixed(1)}B`;
      document.getElementById('tam2033').textContent = `$${(forecast.values[9] / 1e9).toFixed(1)}B`;
      document.getElementById('unidades2033').textContent = `${(forecast.units[9] / 1e6).toFixed(1)}M`;
      
      // Update table
      const tableBody = document.getElementById('forecastTable');
      tableBody.innerHTML = '';
      
      for (let i = 1; i <= 9; i++) {
        const row = document.createElement('tr');
        const growthYoy = i > 0 ? ((forecast.values[i] / forecast.values[i-1] - 1) * 100).toFixed(1) : '-';
        const priceAvg = forecast.values[i] / forecast.units[i];
        
        row.innerHTML = `
          <td>${forecast.years[i]}</td>
          <td>${(forecast.units[i] / 1e6).toFixed(2)}</td>
          <td>$${priceAvg.toFixed(0)}</td>
          <td>$${(forecast.values[i] / 1e9).toFixed(1)}B</td>
          <td>${growthYoy}%</td>
          <td>$${(forecast.kitRevenue[i] / 1e9).toFixed(2)}B</td>
          <td>$${(forecast.prehungRevenue[i] / 1e9).toFixed(2)}B</td>
        `;
        tableBody.appendChild(row);
      }
      
      // Update chart
      updateForecastChart(forecast);
    }

    // Initialize Charts
    let forecastChart, marginChart, channelProfitChart, workingCapitalChart;

    function initCharts() {
      // Forecast Chart
      const forecastCtx = document.getElementById('forecastChart').getContext('2d');
      forecastChart = new Chart(forecastCtx, {
        type: 'line',
        data: {
          labels: [],
          datasets: [
            {
              label: 'TAM Base (MXN B)',
              data: [],
              borderColor: 'rgba(59, 130, 246, 1)',
              backgroundColor: 'rgba(59, 130, 246, 0.1)',
              borderWidth: 3,
              tension: 0.4
            },
            {
              label: 'TAM Alcista (MXN B)',
              data: [],
              borderColor: 'rgba(16, 185, 129, 1)',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              borderWidth: 2,
              borderDash: [5, 5],
              tension: 0.4
            },
            {
              label: 'TAM Bajista (MXN B)',
              data: [],
              borderColor: 'rgba(245, 158, 11, 1)',
              backgroundColor: 'rgba(245, 158, 11, 0.1)',
              borderWidth: 2,
              borderDash: [5, 5],
              tension: 0.4
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'Proyecci√≥n TAM 2024-2033',
              font: { size: 16, weight: 'bold' }
            },
            legend: {
              position: 'bottom'
            }
          },
          scales: {
            y: {
              beginAtZero: false,
              ticks: {
                callback: function(value) {
                  return '$' + (value / 1e9).toFixed(0) + 'B';
                }
              }
            }
          }
        }
      });

      // Margin Waterfall Chart
      const marginCtx = document.getElementById('marginChart').getContext('2d');
      marginChart = new Chart(marginCtx, {
        type: 'bar',
        data: {
          labels: ['Costo Base', 'Margen Hoja', 'Kit Adicional', 'Pre-hung Adicional', 'Instalaci√≥n', 'Margen Total'],
          datasets: [{
            label: 'Cascada de M√°rgenes',
            data: [350, 200, 160, 245, 225, 680],
            backgroundColor: [
              'rgba(220, 38, 38, 0.8)',
              'rgba(59, 130, 246, 0.8)',
              'rgba(16, 185, 129, 0.8)',
              'rgba(16, 185, 129, 0.8)',
              'rgba(16, 185, 129, 0.8)',
              'rgba(245, 158, 11, 0.8)'
            ],
            borderColor: [
              'rgba(220, 38, 38, 1)',
              'rgba(59, 130, 246, 1)',
              'rgba(16, 185, 129, 1)',
              'rgba(16, 185, 129, 1)',
              'rgba(16, 185, 129, 1)',
              'rgba(245, 158, 11, 1)'
            ],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'Construcci√≥n de Margen por Producto (MXN)',
              font: { size: 16, weight: 'bold' }
            },
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return '$' + value;
                }
              }
            }
          }
        }
      });

      // Channel Profitability Chart
      const channelProfitCtx = document.getElementById('channelProfitChart').getContext('2d');
      channelProfitChart = new Chart(channelProfitCtx, {
        type: 'radar',
        data: {
          labels: ['Volumen', 'Margen', 'GMROI', 'Attach Rate', 'Precio'],
          datasets: [
            {
              label: 'Ferreter√≠as',
              data: [85, 65, 64, 40, 55],
              borderColor: 'rgba(59, 130, 246, 1)',
              backgroundColor: 'rgba(59, 130, 246, 0.2)',
              borderWidth: 2
            },
            {
              label: 'Constructoras',
              data: [75, 45, 42, 70, 35],
              borderColor: 'rgba(16, 185, 129, 1)',
              backgroundColor: 'rgba(16, 185, 129, 0.2)',
              borderWidth: 2
            },
            {
              label: 'Retail Moderno',
              data: [30, 80, 90, 75, 80],
              borderColor: 'rgba(245, 158, 11, 1)',
              backgroundColor: 'rgba(245, 158, 11, 0.2)',
              borderWidth: 2
            },
            {
              label: 'Institucional',
              data: [20, 90, 56, 90, 100],
              borderColor: 'rgba(220, 38, 38, 1)',
              backgroundColor: 'rgba(220, 38, 38, 0.2)',
              borderWidth: 2
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'Perfil de Rentabilidad por Canal',
              font: { size: 14, weight: 'bold' }
            }
          },
          scales: {
            r: {
              beginAtZero: true,
              max: 100
            }
          }
        }
      });

      // Working Capital Chart
      const workingCapitalCtx = document.getElementById('workingCapitalChart').getContext('2d');
      workingCapitalChart = new Chart(workingCapitalCtx, {
        type: 'bar',
        data: {
          labels: ['Ferreter√≠as', 'Constructoras', 'Retail Moderno', 'Institucional'],
          datasets: [{
            label: 'D√≠as de Capital de Trabajo',
            data: [37, 75, 52, 105],
            backgroundColor: [
              'rgba(59, 130, 246, 0.8)',
              'rgba(220, 38, 38, 0.8)',
              'rgba(16, 185, 129, 0.8)',
              'rgba(245, 158, 11, 0.8)'
            ],
            borderColor: [
              'rgba(59, 130, 246, 1)',
              'rgba(220, 38, 38, 1)',
              'rgba(16, 185, 129, 1)',
              'rgba(245, 158, 11, 1)'
            ],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'Capital de Trabajo por Canal (D√≠as)',
              font: { size: 14, weight: 'bold' }
            },
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return value + ' d√≠as';
                }
              }
            }
          }
        }
      });
    }

    function updateForecastChart(forecast) {
      // Calculate different scenarios
      const baseData = forecast.values.map(v => v / 1e9);
      const alcistaData = forecast.values.map(v => v * 1.33 / 1e9); // +33% scenario
      const bajistaData = forecast.values.map(v => v * 0.75 / 1e9); // -25% scenario
      
      forecastChart.data.labels = forecast.years;
      forecastChart.data.datasets[0].data = baseData;
      forecastChart.data.datasets[1].data = alcistaData;
      forecastChart.data.datasets[2].data = bajistaData;
      forecastChart.update();
    }

    // Slider handlers
    document.getElementById('cagrSlider').addEventListener('input', function(e) {
      currentParams.cagr = parseFloat(e.target.value);
      document.getElementById('cagrValue').textContent = currentParams.cagr.toFixed(2) + '%';
      updateForecast();
    });

    document.getElementById('shockSlider').addEventListener('input', function(e) {
      currentParams.shock = parseFloat(e.target.value);
      document.getElementById('shockValue').textContent = 
        (currentParams.shock >= 0 ? '+' : '') + currentParams.shock.toFixed(1) + 'pp';
      updateForecast();
    });

    document.getElementById('kitSlider').addEventListener('input', function(e) {
      currentParams.attachKit = parseInt(e.target.value);
      document.getElementById('kitValue').textContent = currentParams.attachKit + '%';
      updateForecast();
    });

    document.getElementById('prehungSlider').addEventListener('input', function(e) {
      currentParams.attachPrehung = parseInt(e.target.value);
      document.getElementById('prehungValue').textContent = currentParams.attachPrehung + '%';
      updateForecast();
    });

    // Scenario buttons
    function setScenario(scenario) {
      currentScenario = scenario;
      
      // Update button states
      document.querySelectorAll('.scenario-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.closest('.scenario-btn').classList.add('active');
      
      // Set parameters based on scenario
      switch(scenario) {
        case 'base':
          currentParams.cagr = 5.65;
          currentParams.shock = 0;
          currentParams.attachKit = 22;
          currentParams.attachPrehung = 8;
          break;
        case 'alcista':
          currentParams.cagr = 7.5;
          currentParams.shock = 0;
          currentParams.attachKit = 35;
          currentParams.attachPrehung = 15;
          break;
        case 'bajista':
          currentParams.cagr = 3.0;
          currentParams.shock = 0;
          currentParams.attachKit = 15;
          currentParams.attachPrehung = 5;
          break;
      }
      
      // Update sliders
      document.getElementById('cagrSlider').value = currentParams.cagr;
      document.getElementById('shockSlider').value = currentParams.shock;
      document.getElementById('kitSlider').value = currentParams.attachKit;
      document.getElementById('prehungSlider').value = currentParams.attachPrehung;
      
      // Update displays
      document.getElementById('cagrValue').textContent = currentParams.cagr.toFixed(2) + '%';
      document.getElementById('shockValue').textContent = 
        (currentParams.shock >= 0 ? '+' : '') + currentParams.shock.toFixed(1) + 'pp';
      document.getElementById('kitValue').textContent = currentParams.attachKit + '%';
      document.getElementById('prehungValue').textContent = currentParams.attachPrehung + '%';
      
      updateForecast();
    }

    // Export functions
    function exportCSV() {
      const forecast = calculateForecast();
      let csv = 'Year,Units (M),TAM (MXN B),Growth YoY,Kit Revenue (B),Pre-hung Revenue (B)\n';
      
      for (let i = 0; i < forecast.years.length; i++) {
        const growthYoy = i > 0 ? ((forecast.values[i] / forecast.values[i-1] - 1) * 100).toFixed(1) : '0';
        csv += `${forecast.years[i]},${(forecast.units[i] / 1e6).toFixed(2)},${(forecast.values[i] / 1e9).toFixed(1)},${growthYoy}%,${(forecast.kitRevenue[i] / 1e9).toFixed(2)},${(forecast.prehungRevenue[i] / 1e9).toFixed(2)}\n`;
      }
      
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `door-industry-forecast-${currentScenario}-2025-2033.csv`;
      a.click();
    }

    function exportJSON() {
      const exportData = {
        metadata: {
          version: '2.0',
          generated: new Date().toISOString(),
          scenario: currentScenario,
          type: 'seed_data'
        },
        parameters: currentParams,
        assumptions: dataModel.assumptions,
        market: dataModel.market,
        costs: dataModel.costs,
        channels: dataModel.channels,
        forecast: calculateForecast()
      };
      
      const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `door-industry-assumptions-${currentScenario}-2025.json`;
      a.click();
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'f' || e.key === 'F') {
        if (!document.fullscreenElement) {
          document.documentElement.requestFullscreen();
        } else {
          document.exitFullscreen();
        }
      }
    });

    // Initialize everything
    window.addEventListener('DOMContentLoaded', () => {
      initNavigation();
      initCharts();
      updateForecast();
      
      // Scroll handler
      window.addEventListener('scroll', updateProgress);
      
      // GSAP animations
      gsap.registerPlugin(ScrollTrigger);
      
      gsap.utils.toArray('.metric-card').forEach(card => {
        gsap.fromTo(card, 
          { opacity: 0, y: 30 },
          {
            opacity: 1,
            y: 0,
            duration: 0.6,
            scrollTrigger: {
              trigger: card,
              start: 'top 80%',
              end: 'bottom 20%',
              toggleActions: 'play none none reverse'
            }
          }
        );
      });
      
      console.log('Forecast & Economics Model Loaded', dataModel);
    });
  </script>

  <!-- FASE 2 COMPLETA -->
</body>
</html>